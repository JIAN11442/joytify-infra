version: "3"

env:
  DIR: "{{.TASKFILE_DIR}}"
  CERTIFICATES_MANAGER_DIR: "{{.DIR}}/certificates/manager"
  CERTIFICATES_ISSUERS_DIR: "{{.DIR}}/certificates/issuers"
  CERTIFICATES_RESTORE_DIR: "{{.DIR}}/certificates/restore"
  CERTIFICATES_BACKUP_DIR: "{{.DIR}}/certificates/backup"
  CREDENTIALS_DIR: "{{.DIR}}/credentials"

tasks:
  # =============================================================================
  # INDIVIDUAL COMPONENTS (Deploy specific platform services)
  # =============================================================================

  certificates:manager:plan:
    desc: "ðŸ“‹ Plan Cert Manager changes"
    dir: "{{.CERTIFICATES_MANAGER_DIR}}"
    cmds:
      - terragrunt plan --non-interactive
    summary: |
      Shows planned changes for Cert Manager

  certificates:manager:validate:
    desc: "âœ… Validate Cert Manager configuration"
    dir: "{{.CERTIFICATES_MANAGER_DIR}}"
    cmds:
      - terragrunt validate --non-interactive
    summary: |
      Validates the Cert Manager configuration

  certificates:manager:deploy:
    desc: "ðŸš€ Deploy only Cert Manager"
    dir: "{{.CERTIFICATES_MANAGER_DIR}}"
    cmds:
      - terragrunt apply --non-interactive -auto-approve
    summary: |
      Deploys only the Cert Manager component

  certificates:manager:destroy:
    desc: "ðŸ’¥ Destroy only Cert Manager"
    dir: "{{.CERTIFICATES_MANAGER_DIR}}"
    cmds:
      - terragrunt destroy --non-interactive -auto-approve
    summary: |
      Destroys only the Cert Manager component

  certificates:manager:output:
    desc: "ðŸ“¤ Show Cert Manager outputs"
    dir: "{{.CERTIFICATES_MANAGER_DIR}}"
    cmds:
      - terragrunt output --non-interactive
    summary: |
      Displays all outputs from Cert Manager

  certificates:issuers:plan:
    desc: "ðŸ“‹ Plan Cert Issuers changes"
    dir: "{{.CERTIFICATES_ISSUERS_DIR}}"
    cmds:
      - terragrunt plan --non-interactive
    summary: |
      Shows planned changes for Cert Issuers

  certificates:issuers:validate:
    desc: "âœ… Validate Cert Issuers configuration"
    dir: "{{.CERTIFICATES_ISSUERS_DIR}}"
    cmds:
      - terragrunt validate --non-interactive
    summary: |
      Validates the Cert Issuers configuration

  certificates:issuers:deploy:
    desc: "ðŸš€ Deploy only Cert Issuers"
    dir: "{{.CERTIFICATES_ISSUERS_DIR}}"
    cmds:
      - terragrunt apply --non-interactive -auto-approve
    summary: |
      Deploys only the Cert Issuers component

  certificates:issuers:destroy:
    desc: "ðŸ’¥ Destroy only Cert Issuers"
    dir: "{{.CERTIFICATES_ISSUERS_DIR}}"
    cmds:
      - terragrunt destroy --non-interactive -auto-approve
    summary: |
      Destroys only the Cert Issuers component

  certificates:issuers:output:
    desc: "ðŸ“¤ Show Cert Issuers outputs"
    dir: "{{.CERTIFICATES_ISSUERS_DIR}}"
    cmds:
      - terragrunt output --non-interactive
    summary: |
      Displays all outputs from Cert Issuers

  certificates:restore:plan:
    desc: "ðŸ“‹ Plan Cert Restore changes"
    dir: "{{.CERTIFICATES_RESTORE_DIR}}"
    cmds:
      - terragrunt plan --non-interactive
    summary: |
      Shows planned changes for Cert Restore

  certificates:restore:validate:
    desc: "âœ… Validate Cert Restore configuration"
    dir: "{{.CERTIFICATES_RESTORE_DIR}}"
    cmds:
      - terragrunt validate --non-interactive
    summary: |
      Validates the Cert Restore configuration

  certificates:restore:deploy:
    desc: "ðŸš€ Deploy only Cert Restore"
    dir: "{{.CERTIFICATES_RESTORE_DIR}}"
    cmds:
      - terragrunt apply --non-interactive -auto-approve
    summary: |
      Deploys only the Cert Restore component

  certificates:restore:destroy:
    desc: "ðŸ’¥ Destroy only Cert Restore"
    dir: "{{.CERTIFICATES_RESTORE_DIR}}"
    cmds:
      - terragrunt destroy --non-interactive -auto-approve
    summary: |
      Destroys only the Cert Restore component

  certificates:restore:output:
    desc: "ðŸ“¤ Show Cert Restore outputs"
    dir: "{{.CERTIFICATES_RESTORE_DIR}}"
    cmds:
      - terragrunt output --non-interactive
    summary: |
      Displays all outputs from Cert Restore

  certificates:backup:plan:
    desc: "ðŸ“‹ Plan Cert Backup changes"
    dir: "{{.CERTIFICATES_BACKUP_DIR}}"
    cmds:
      - terragrunt plan --non-interactive
    summary: |
      Shows planned changes for Cert Backup

  certificates:backup:validate:
    desc: "âœ… Validate Cert Backup configuration"
    dir: "{{.CERTIFICATES_BACKUP_DIR}}"
    cmds:
      - terragrunt validate --non-interactive
    summary: |
      Validates the Cert Backup configuration

  certificates:backup:deploy:
    desc: "ðŸš€ Deploy only Cert Backup"
    dir: "{{.CERTIFICATES_BACKUP_DIR}}"
    cmds:
      - terragrunt apply --non-interactive -auto-approve
    summary: |
      Deploys only the Cert Backup component

  certificates:backup:destroy:
    desc: "ðŸ’¥ Destroy only Cert Backup"
    dir: "{{.CERTIFICATES_BACKUP_DIR}}"
    cmds:
      - terragrunt destroy --non-interactive -auto-approve
    summary: |
      Destroys only the Cert Backup component

  certificates:backup:output:
    desc: "ðŸ“¤ Show Cert Backup outputs"
    dir: "{{.CERTIFICATES_BACKUP_DIR}}"
    cmds:
      - terragrunt output --non-interactive
    summary: |
      Displays all outputs from Cert Backup

  credentials:plan:
    desc: "ðŸ“‹ Plan Credentials changes"
    dir: "{{.CREDENTIALS_DIR}}"
    cmds:
      - terragrunt plan --non-interactive
    summary: |
      Shows planned changes for Credentials

  credentials:validate:
    desc: "âœ… Validate Credentials configuration"
    dir: "{{.CREDENTIALS_DIR}}"
    cmds:
      - terragrunt validate --non-interactive
    summary: |
      Validates the Credentials configuration

  credentials:deploy:
    desc: "ðŸš€ Deploy only Credentials"
    dir: "{{.CREDENTIALS_DIR}}"
    cmds:
      - terragrunt apply --non-interactive -auto-approve
    summary: |
      Deploys only the Credentials component

  credentials:destroy:
    desc: "ðŸ’¥ Destroy only Credentials"
    dir: "{{.CREDENTIALS_DIR}}"
    cmds:
      - terragrunt destroy --non-interactive -auto-approve
    summary: |
      Destroys only the Credentials component

  credentials:output:
    desc: "ðŸ“¤ Show Credentials outputs"
    dir: "{{.CREDENTIALS_DIR}}"
    cmds:
      - terragrunt output --non-interactive
    summary: |
      Displays all outputs from Credentials
